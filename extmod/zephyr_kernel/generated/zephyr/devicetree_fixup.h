/*
 * Devicetree macro stubs for MicroPython Zephyr integration
 *
 * These stubs provide minimal devicetree support to allow Zephyr headers
 * to compile without a full devicetree build.
 */

#ifndef MICROPYTHON_DEVICETREE_FIXUP_H
#define MICROPYTHON_DEVICETREE_FIXUP_H

/* Stub out the DT_FOREACH_OKAY_HELPER macro that device.h tries to use */
/* This macro is supposed to be generated by the build system, but we don't use devices */
#ifndef DT_FOREACH_OKAY_HELPER
#define DT_FOREACH_OKAY_HELPER(fn) /* empty - no devices */
#endif

/* Ensure DT_HAS_COMPAT_STATUS_OKAY always returns 0 (no devices) */
#ifndef DT_HAS_COMPAT_STATUS_OKAY
#define DT_HAS_COMPAT_STATUS_OKAY(compat) 0
#endif

/* Define specific NVIC devicetree properties that Zephyr needs */
/* NUM_IRQ_PRIO_BITS: Derive from device-specific CMSIS header __NVIC_PRIO_BITS */
#ifndef DT_N_INST_0_arm_v7m_nvic_P_arm_num_irq_priority_bits
  #if defined(__NVIC_PRIO_BITS)
    #define DT_N_INST_0_arm_v7m_nvic_P_arm_num_irq_priority_bits __NVIC_PRIO_BITS
  #else
    #define DT_N_INST_0_arm_v7m_nvic_P_arm_num_irq_priority_bits 3  // Fallback for Cortex-M3
  #endif
#endif

#endif /* MICROPYTHON_DEVICETREE_FIXUP_H */
